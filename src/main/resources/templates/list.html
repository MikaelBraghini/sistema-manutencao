<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sistema de Manutenção</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body class="bg-gray-100 text-gray-800">
    <nav class="bg-gray-800 shadow-md">
      <div class="container mx-auto px-6 py-3">
        <a class="text-white text-2xl font-bold" th:href="@{/manutencao}"
          >Sistema de Manutenção</a
        >
      </div>
    </nav>

    <main class="container mx-auto p-6 md:p-8">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-700">Ordens de Serviço</h1>
        <a
          th:href="@{/manutencao/create}"
          class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105"
        >
          &#43; Nova OS
        </a>
      </div>

      <div
        th:if="${#lists.isEmpty(manutencoes)}"
        class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg"
        role="alert"
      >
        <p class="font-bold">Aviso</p>
        <p>Nenhuma Ordem de Serviço cadastrada no momento.</p>
      </div>

      <div
        class="bg-white shadow-md rounded-lg overflow-hidden"
        th:unless="${#lists.isEmpty(manutencoes)}"
      >
        <table class="min-w-full leading-normal">
          <thead class="bg-gray-200">
            <tr>
              <th
                class="py-3 px-5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                OS
              </th>
              <th
                class="py-3 px-5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                Equipamento
              </th>
              <th
                class="py-3 px-5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                Descrição
              </th>
              <th
                class="py-3 px-5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                Criado em
              </th>
              <th
                class="py-3 px-5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                Finalizado em
              </th>
              <th
                class="py-3 px-5 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider"
              >
                Ações
              </th>
            </tr>
          </thead>
          <tbody class="text-gray-700">
            <tr
              th:each="manutencao : ${manutencoes}"
              class="border-b border-gray-200 hover:bg-gray-100 transition duration-150"
            >
              <td
                class="py-3 px-5 text-left whitespace-nowrap"
                th:text="${manutencao.id}"
              >
                1
              </td>
              <td class="py-3 px-5 text-left" th:text="${manutencao.item}">
                Notebook Dell
              </td>
              <td
                class="py-3 px-5 text-left"
                th:text="${manutencao.description}"
              >
                Tela quebrada
              </td>
              <td
                class="py-3 px-5 text-left"
                th:text="${manutencao.createdAt != null ? #temporals.format(manutencao.createdAt, 'dd/MM/yyyy HH:mm') : 'N/A'}"
              >
                --
              </td>

              <td class="py-3 px-5 text-left">
                <span
                  th:if="${manutencao.finisheadAt}"
                  th:text="${#temporals.format(manutencao.finisheadAt, 'dd/MM/yyyy HH:mm')}"
                  >--</span
                >
                <span
                  th:unless="${manutencao.finisheadAt}"
                  class="text-gray-400 italic"
                  >Pendente</span
                >
              </td>

              <td class="py-3 px-5 text-center">
                <div class="flex item-center justify-center space-x-2">
                  <form
                    class="inline-block"
                    th:action="@{/manutencao/finish/{id}(id=${manutencao.id})}"
                    method="post"
                  >
                    <button
                      type="submit"
                      th:disabled="${manutencao.finisheadAt != null}"
                      class="py-1 px-3 rounded-full text-xs font-semibold text-white transition duration-300"
                      th:classappend="${manutencao.finisheadAt == null} ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-400 cursor-not-allowed'"
                    >
                      Finalizar
                    </button>
                  </form>

                  <a
                    th:href="@{/manutencao/edit/{id}(id=${manutencao.id})}"
                    class="inline-block py-1 px-3 rounded-full text-xs font-semibold text-white transition duration-300"
                    th:classappend="${manutencao.finisheadAt != null} ? 'pointer-events-none bg-gray-400' : 'bg-yellow-500 hover:bg-yellow-600'"
                  >
                    Editar
                  </a>

                  <a
                    th:href="@{/manutencao/delete/{id}(id=${manutencao.id})}"
                    class="inline-block bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded-full text-xs font-semibold transition duration-300"
                  >
                    Excluir
                  </a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </main>
  </body>
</html>
